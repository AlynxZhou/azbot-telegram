<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: bot-utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: bot-utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module botUtils
 */
const fs = require('fs')
const path = require('path')

const FormData = require('form-data')

/**
 * @param {Object} update Telegram update.
 * @return {String} A string which can be used as key.
 */
const perFromID = (update) => {
  if (update != null &amp;&amp;
      update['message'] != null &amp;&amp;
      update['message']['from'] != null &amp;&amp;
      update['message']['from']['id'] != null) {
    return `${update['message']['from']['id']}`
  }
  return `0`
}

/**
 * @param {Object} update Telegram update.
 * @return {String} A string which can be used as key.
 */
const perChatID = (update) => {
  if (update != null &amp;&amp;
      update['message'] != null &amp;&amp;
      update['message']['chat'] != null &amp;&amp;
      update['message']['chat']['id'] != null) {
    return `${update['message']['chat']['id']}`
  }
  return `0`
}

/**
 * @param {*} o
 * @return {Boolean}
 */
const isString = (o) => {
  return typeof(o) === "string"
}

/**
 * @param {*} o
 * @return {Boolean}
 */
const isArray = (o) => {
  return Array.isArray(o)
}

/**
 * @param {*} o
 * @return {Boolean}
 */
const isFunction = (o) => {
  return o instanceof Function
}

/**
 * @param {*} o
 * @return {Boolean} Return `false` when `o == null`.
 */
const isObject = (o) => {
  return typeof(o) === "object" &amp;&amp; o != null
}

/**
 * @param {*} o
 * @return {Boolean}
 */
const isBuffer = (o) => {
  return Buffer.isBuffer(o)
}

/**
 * @param {*} o
 * @return {Boolean}
 */
const isFormData = (o) => {
  return o instanceof FormData
}

/**
 * @description Replace camelCase to snake_case, e.g. `_ChatID` to `_chat_id`.
 * @param {String} camelCase
 * @return {String} snake_case of input.
 */
const toSnakeCase = (camelCase) => {
  // ['chatId', 'chatID', 'chat_ID', 'chat_id', 'chat__ID', 'chat_I_D', '_ChatID', 'chatID_', '_ID', 'ChatID'].map(toSnakeCase)
  return camelCase
    // CamelCase in line head is replaced by lower case.
    // This must be the first to escape from the 3rd regexp.
    // `Chat_id` to `chat_id`
    .replace(/^([A-Z]+)/g, (match, p1) => {
      return p1.toLowerCase()
    })
    // CamelCase after a underscore is replaced by lower case.
    // `chat_ID` to `chat_id`
    .replace(/(_[A-Z]+)/g, (match, p1) => {
      return p1.toLowerCase()
    })
    // CamelCase without a underscore and not in line head
    // is replaced by lower case with underscore.
    // `chatID` to `chat_id`
    .replace(/([A-Z]+)/g, (match, p1) => {
      return `_${p1.toLowerCase()}`
    })
}

/**
 * @description Assign Objects into one Object which keys are all transfered into snake_case.
 * @param {...Object}
 * @return {Object} Assigned snake_case Object.
 */
const toSnakeCaseObject = (...objects) => {
  return Object.assign(...objects.map((object) => {
    return Object.fromEntries(Object.entries(object).map((entry) => {
      return [toSnakeCase(entry[0]), entry[1]]
    }))
  }))
}

/**
 * @description Assign Objects into one FormData which keys are all transfered into snake_case.
 * @param {...Object}
 * @return {FormData} Assigned snake_case FormData.
 */
const toSnakeCaseFormData = (...objects) => {
  const formData = new FormData()
  for (let object of objects) {
    for (let entry of Object.entries) {
      formData.append(toSnakeCase(entry[0]), entry[1])
    }
  }
  return formData
}

module.exports = {
  perFromID,
  perChatID,
  isString,
  isArray,
  isFunction,
  isObject,
  isBuffer,
  isFormData,
  toSnakeCase,
  toSnakeCaseObject,
  toSnakeCaseFormData
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-BotAPI.html">BotAPI</a></li><li><a href="module-BotLogger.html">BotLogger</a></li><li><a href="module-BotMaster.html">BotMaster</a></li><li><a href="module-BotPoller.html">BotPoller</a></li><li><a href="module-BotServant.html">BotServant</a></li><li><a href="module-botUtils.html">botUtils</a></li></ul><h3>Classes</h3><ul><li><a href="module-BotAPI-BotAPI.html">BotAPI</a></li><li><a href="module-BotLogger-BotLogger.html">BotLogger</a></li><li><a href="module-BotMaster-BotMaster.html">BotMaster</a></li><li><a href="module-BotPoller-BotPoller.html">BotPoller</a></li><li><a href="module-BotServant-BotServant.html">BotServant</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Oct 13 2019 22:47:41 GMT+0800 (China Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
